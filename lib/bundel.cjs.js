"use strict";const t={100:"未初始化",101:"参数类型错误",102:"参数缺失",103:"重复调用"},e=t=>!!window.localStorage&&(localStorage.getItem(t)||"none"),n=({msg:e,desc:n}={})=>{console.error(`\n     ErrorType: <${t[e]}>,\n     ErrorDesc: ${n}\n  `)},{screen:{width:r,height:o}}=window,i={screenWidth:r,screenHeight:o,browser:(()=>{const t=window.window.navigator.userAgent.toLowerCase(),e={ie:/msie/.test(t)&&!/opera/.test(t),opera:/opera/.test(t),safari:/version.*safari/.test(t),chrome:/chrome/.test(t),firefox:/gecko/.test(t)&&!/webkit/.test(t)};return Object.keys(e).filter((t=>{if(e[t])return t})).join(",")})()||"other",os:(()=>{const t="Win32"==window.navigator.platform||"Windows"==window.navigator.platform,e="Mac68K"==window.navigator.platform||"MacPPC"==window.navigator.platform||"Macintosh"==window.navigator.platform||"MacIntel"==window.navigator.platform,n=String(window.navigator.platform).indexOf("Linux")>-1,r="X11"==window.navigator.platform&&!t&&!e;return t?"window":e?"Mac":r?"Unix":n?"Linux":"other"})()};var a="webtrace-sdk",s="1.0.3";const c={requestUrl:"",deviceInfo:i,pv:!1,performance:!1,error:!0,debug:!1,catch:!0};(()=>{const t=e("Webtrace_UUID");if(t&&"none"!==t)return t;const n=(new Date).getTime()+"",r=Math.floor(100*Math.random()),o=((t=1)=>{let e="";for(let n=0;n<t;n++)e+=String.fromCharCode(Math.floor(26*Math.random())+"a".charCodeAt(0));return e})(3)+"_"+n.substring(8,13)+"_"+r;"none"==t&&localStorage.setItem("Webtrace_UUID",o)})();var d={init(t){const{options:e={},appId:n,requestUrl:r}=t;c.requestUrl=r,Object.assign(c,e)}},g={init(){if(!c.error)return!1;window.addEventListener("error",(t=>{console.log("error1",t)})),window.addEventListener("unhandledrejection",(t=>{console.log("error2",t.reason)}))}};const l=new Map;var w={init(){window.document.addEventListener("visibilitychange",(()=>{})),window.onbeforeunload=function(t){}}};const m=t=>{if(l.has(`${t}__again__`))return l.delete(`${t}__again__`),!1;if(!l.has(t))return n({msg:"100",desc:`不存在'${t}'事件的时间初始化方法,如需统计请先调用timeStart('${t}')方法`}),!1;const e=l.get(t),r=((t,e)=>{let n=(t=t.toString()).indexOf(".");return t=-1!==n?t.substring(0,e+n+1):t.substring(0),parseFloat(t).toFixed(e)})(((new Date).getTime()-e)/1e3,5);l.delete(t),console.log(`'${t}'事件，一共耗时${r}秒`)};class p{constructor(t={}){console.log("实例被创建"+(new Date).getTime()),this.init(t)}init(t){d.init(t),g.init(),w.init()}timeStart(t){(t=>{if(!l.has(t))return l.set(t,(new Date).getTime()),!1;l.set(`${t}__again__`,!0),n({msg:"103",desc:`timeStart('${t}')已完成初始化,在timeEnd('${t}')触发前,请勿重复调用`})})(t)}timeEnd(t){m(t)}}var f={name:a,version:s,init:function(t={}){if("[object Object]"!==Object.prototype.toString.call(t))return n({msg:"101",desc:"init()方法需要传入一个配置参数,类型为object"}),!1;{const{appId:e,requestUrl:r,options:o}=t;if(((t,e,r)=>{let o=!0;return t&&e?"string"!=typeof t?(o=!1,n({msg:"101",desc:"init()参数appId类型必须为string类型"}),o):"string"==typeof e&&/http/.test(e)?r&&"[object Object]"!==Object.prototype.toString.call(r)?(o=!1,n({msg:"101",desc:"init()如果配置了options参数,类型必须为object"}),o):o:(o=!1,n({msg:"101",desc:"init()参数requestUrl必须是http地址"}),o):(o=!1,n({msg:"102",desc:"init()参数appId和requestUrl不能为空"}),o)})(e,r,o)){const e=new p(t);window.sdk=e}}}};module.exports=f;
